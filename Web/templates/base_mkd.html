<!DOCTYPE html>
<html lang="mkd">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">

    <!-- External CSS files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo/favicon.png') }}">
    <link rel="icon" type="image/x-con" href="{{ url_for('static', filename='images/logo/favicon.ico') }}">

    {% block head %}{% endblock head %}

    <!-- External script (Font Awesome) with nonce -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" 
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" 
      crossorigin="anonymous" referrerpolicy="no-referrer" />

    <title>{% block title %}Market Watcher{% endblock %}</title>
</head>

<!-- External JS file with nonce -->
<script nonce="{{ g.nonce }}" src="{{ url_for('static', filename='js/base.js') }}"></script>

<body class="{% block body_class %}flex-layout{% endblock %}">
    <header>
        <div class="navbar">
            <div class="logo">
                <img src="{{ url_for('static', filename='images/logo/favicon.ico') }}" alt="logo">
                <h1 class="site-name">Market Watcher</h1>
            </div>
            <ul class="links">
                <li><a href="{{ url_for('index_lang', lang='mkd')}}"><i class="fa-solid fa-house"></i> –î–æ–º–∞</li></a>
                <li><a href="{{ url_for('about', lang='mkd')}}"><i class="fa-solid fa-circle-info"></i> –ò–Ω—Ñ–æ</li></a>
                <li><a href="{{ url_for('contact', lang='mkd')}}"><i class="fa-solid fa-address-book"></i> –ö–æ–Ω—Ç–∞–∫—Ç</li></a>

                <ul class="navbar-nav ms-auto">
                    {% if current_user.is_authenticated %}
                        <li class="nav-item dropdown">
                            <div class="dropdown-wrapper">
                                <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button">
                                    <i class="fas fa-user"></i> {{ current_user.username }}
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                    <li><a class="dropdown-item" href="{{ url_for('profile', lang=request.cookies.get('lang', 'en')) }}">–ú–æ—ò –ø—Ä–æ—Ñ–∏–ª</a></li>
                                
                                    {% if current_user.role == 'admin' %}
                                        <li><a class="dropdown-item" href="{{ url_for('admin_users') }}">–£–ø—Ä–∞–≤—É–≤–∞—ö–µ —Å–æ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏</a></li>
                                    {% endif %}
                                    
                                    <li><a class="dropdown-item" href="{{ url_for('logout', lang=request.cookies.get('lang', 'en')) }}">–û–¥—ò–∞–≤–∏ —Å–µ</a></li>
                                </ul>
                            </div>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('login', lang=request.cookies.get('lang', 'en')) }}">
                                <i class="fas fa-sign-in-alt"></i> –ù–∞—ò–∞–≤–∞
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('register', lang=request.cookies.get('lang', 'en')) }}">
                                <i class="fas fa-user-plus"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞
                            </a>
                        </li>
                    {% endif %}
                </ul>

                <ul class="lang-menu">
                    <li>
                        <a href="{{ url_for('set_language', lang='en', next=request.path) }}" class="lang-btn">
                            <img src="https://flagcdn.com/w40/gb.png" alt="English" width="20"> EN
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('set_language', lang='mkd', next=request.path) }}" class="lang-btn">
                            <img src="https://flagcdn.com/w40/mk.png" alt="Macedonian" width="20"> MKD
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('set_language', lang='al', next=request.path) }}" class="lang-btn">
                            <img src="https://flagcdn.com/w40/al.png" alt="Albanian" width="20"> AL
                        </a>
                    </li>
                </ul>
            </ul>
            <div class="toggle_btn">
                <i class="fa-solid fa-bars"></i>
            </div>
            
            <div class="dropdown_menu">
                <a href="{{ url_for('index_lang', lang='mkd')}}"><li><i class="fa-solid fa-house"></i> –î–æ–º–∞</li></a>
                <a href="{{ url_for('about', lang='mkd')}}"><li><i class="fa-solid fa-circle-info"></i> –ò–Ω—Ñ–æ</li></a>
                <a href="{{ url_for('contact', lang='mkd')}}"><li><i class="fa-solid fa-address-book"></i> –ö–æ–Ω—Ç–∞–∫—Ç</li></a>

                <ul class="navbar-nav ms-auto">
                    {% if current_user.is_authenticated %}
                        <li class="nav-item dropdown">
                            <div class="dropdown-wrapper">
                                <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button">
                                    <i class="fas fa-user"></i> {{ current_user.username }}
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                    <li><a class="dropdown-item" href="{{ url_for('profile', lang=request.cookies.get('lang', 'en')) }}">–ú–æ—ò –ø—Ä–æ—Ñ–∏–ª</a></li>
                                
                                    {% if current_user.role == 'admin' %}
                                        <li><a class="dropdown-item" href="{{ url_for('admin_users') }}">üîß –£–ø—Ä–∞–≤—É–≤–∞—ö–µ —Å–æ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏</a></li>
                                    {% endif %}
                                    
                                    <li><a class="dropdown-item" href="{{ url_for('logout', lang=request.cookies.get('lang', 'en')) }}">–û–¥—ò–∞–≤–∏ —Å–µ</a></li>
                                </ul>
                            </div>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('login', lang=request.cookies.get('lang', 'en')) }}">
                                <i class="fas fa-sign-in-alt"></i> –ù–∞—ò–∞–≤–∞
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('register', lang=request.cookies.get('lang', 'en')) }}">
                                <i class="fas fa-user-plus"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞
                            </a>
                        </li>
                    {% endif %}
                </ul>

                <ul class="lang-menu">
                    <a href="{{ url_for('set_language', lang='en', next=request.path) }}" class="lang-btn">
                        <li>
                            <img src="https://flagcdn.com/w40/gb.png" alt="English" width="20"> EN
                        </li>
                    </a>
                    <a href="{{ url_for('set_language', lang='mkd', next=request.path) }}" class="lang-btn">
                        <li>
                            <img src="https://flagcdn.com/w40/mk.png" alt="Macedonian" width="20"> MKD
                        </li>
                    </a>
                    <a href="{{ url_for('set_language', lang='al', next=request.path) }}" class="lang-btn">
                        <li>
                            <img src="https://flagcdn.com/w40/al.png" alt="Albanian" width="20"> AL
                        </li>
                    </a>
                </ul>
            </div>
        </div>   
    </header>

    <style nonce="{{ g.nonce }}">
        main { flex: 1;}
    </style>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>
        <p>&copy; 2025 –ú–∏–ª–æ—à –°–º–∏—ô–∫–æ–≤–∏—ú</p>
    </footer>

</body>
</html>
